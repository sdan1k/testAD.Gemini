"""
Маппинг отраслей из классификации (docx) к реальным значениям defendant_industry из БД.
Каждая категория уровня 3 (специализация) маппится на список реальных значений.
"""

# Иерархия отраслей из классификации коллег
# Формат: { "Отрасль (Уровень 1)": { "Сфера (Уровень 2)": ["Специализация (Уровень 3)", ...] } }
INDUSTRY_HIERARCHY = {
    "Промышленность и производство": {
        "Тяжелая промышленность и металлургия": [
            "Металлургия",
            "Производство/торговля металлоизделиями",
            "Промышленное оборудование",
            "Промышленное оборудование / B2B-торговля",
            "Промышленное снабжение и оборудование",
            "Авиастроение",
            "Производство спецтехники",
            "Продажа и аренда спецтехники",
            "Продажа спецтехники",
            "Сельскохозяйственная техника",
        ],
        "Легкая промышленность": [
            "Производство одежды / СИЗ",
            "Производство и продажа потребительских товаров",
            "Услуги по пошиву одежды",
            "Услуги по пошиву одежды и обуви",
        ],
        "Пищевая промышленность": [
            "Производство продуктов питания",
            "Пищевая промышленность",
            "Производство напитков",
            "Производство и продажа напитков",
            "Производство алкогольных напитков",
            "Производство и продажа алкогольной продукции",
            "Производство и розничная торговля алкогольной продукцией",
            "Производство кондитерских изделий",
        ],
        "Производство товаров народного потребления": [
            "Производство мебели",
            "Производство и продажа мебели",
            "Услуги по изготовлению мебели",
            "Бытовая химия",
            "Производство и продажа потребительской электроники",
            "Производство деревянной тары",
            "Производство/продажа окон",
            "Продажа и установка окон",
            "Установка окон и дверей",
            "Продажа и установка отопительного оборудования",
            "Производство/торговля отопительным оборудованием",
            "Системы отопления",
            "Производство и продажа теплиц",
            "Продажа емкостей и септиков",
        ],
        "Специализированное производство": [
            "Авиастроение",
            "Производство спецтехники",
            "Продажа спецтехники",
            "Продажа и аренда спецтехники",
            "Медицинское оборудование",
            "Производство БАД и спортивного питания",
            "Производство и продажа спортивного питания",
        ],
    },
    "Торговля": {
        "Розничная торговля (Ритейл)": [
            "Розничная торговля",
            "Розничная торговля (продукты)",
            "Розничная торговля (алкогольная продукция)",
            "Розничная торговля (автозапчасти)",
            "Розничная торговля (автомобили)",
            "Розничная торговля (автомобильные шины)",
            "Розничная торговля (автотовары)",
            "Розничная торговля (аптеки)",
            "Розничная торговля (аптечная сеть)",
            "Розничная торговля (БАДы)",
            "Розничная торговля (БАДы и товары для здоровья)",
            "Розничная торговля (продукты для здоровья / БАДы)",
            "Розничная торговля (товары для здоровья)",
            "Розничная торговля (фармацевтика)",
            "Розничная торговля (медицинские изделия)",
            "Розничная торговля (вейп-продукция)",
            "Розничная торговля (вейп-шоп)",
            "Розничная торговля (вейп-шоп / табачные изделия)",
            "Розничная торговля (табачная продукция)",
            "Розничная торговля (табачные изделия)",
            "Розничная торговля (табачные изделия и вейпы)",
            "Розничная торговля (табачная и никотинсодержащая продукция)",
            "Розничная торговля (никотиносодержащая продукция)",
            "Розничная торговля табачной и никотинсодержащей продукцией",
            "Розничная торговля табачными изделиями",
            "Розничная торговля (топливо)",
            "Розничная торговля моторным топливом",
            "Розничная торговля топливом",
            "Розничная торговля (строительные материалы)",
            "Розничная торговля (мебель/кухни)",
            "Розничная торговля (косметика)",
            "Розничная торговля (электроника и бытовая техника)",
            "Розничная торговля (гаджеты и аксессуары)",
            "Розничная торговля (цветы)",
            "Розничная торговля (двери) и автосервис",
            "Розничная торговля (комиссионный магазин)",
            "Розничная торговля (товары для взрослых)",
            "Розничная торговля (маркетплейс)",
            "Розничная торговля автомобилями",
            "Розничная торговля и ремонт цифровой техники",
            "Розничная торговля и ремонт электроники",
            "Розничная торговля и услуги",
            "Розничная торговля и установка оборудования",
            "Розничная торговля / Общественное питание",
            "Розничная торговля / Скрытые финансовые услуги",
            "Розничная торговля, IT / Рекламные технологии",
            "Автомобильная розничная торговля",
        ],
        "Оптовая торговля (Дистрибуция)": [
            "Оптовая торговля",
            "Оптовая торговля (кабельная продукция, стройматериалы)",
            "Оптовая торговля / B2B Услуги",
            "Оптовая торговля / Поставки",
            "Оптовая торговля / Строительные материалы",
            "Оптовые поставки кабельно-проводниковой продукции",
            "Торговля (B2B)",
            "Дистрибуция алкогольной продукции",
            "Торговля алкогольной продукцией",
            "Торговля строительными материалами",
            "Торговля электротехническим оборудованием",
            "Торговля металлопродукцией",
            "Торговля медицинскими изделиями",
            "B2B поставки",
        ],
        "Электронная коммерция (E-com)": [
            "Интернет-торговля",
            "Электронная коммерция",
            "Электронная коммерция / Рекламные платформы",
            "Розничная торговля (маркетплейс)",
            "Маркетплейсы",
            "Продажа товаров через интернет",
        ],
    },
    "Строительство и недвижимость": {
        "Строительство": [
            "Строительство",
            "Строительство / Девелопмент",
            "Строительство / Недвижимость",
            "Строительство и Недвижимость",
            "Строительство и благоустройство",
            "Строительство и девелопмент",
            "Строительство и металлоконструкции",
            "Строительство и недвижимость",
            "Строительство и ремонт",
            "Строительство/Ремонт",
            "Жилищное строительство",
            "Промышленное строительство",
            "Дорожное строительство",
            "Строительство инженерных сетей",
            "Инженерные системы / Строительство",
            "Строительные услуги",
            "Строительные услуги и грузоперевозки",
        ],
        "Девелопмент и управление недвижимостью": [
            "Девелопмент / Недвижимость",
            "Долевое строительство",
            "Управление недвижимостью",
            "Аренда и управление недвижимостью",
            "Аренда коммерческой недвижимости",
            "Управление коммерческой недвижимостью",
            "Коммерческая недвижимость",
            "Торговая недвижимость",
        ],
        "Ремонт и отделка": [
            "Строительно-ремонтные услуги",
            "Строительные и отделочные услуги",
            "Строительные и ремонтные услуги",
            "Отделочные работы",
            "Установка окон, дверей, отопительного оборудования",
            "Услуги по ремонту и отделке",
            "Услуги по ремонту и строительству",
            "Услуги по ремонту и установке",
            "Услуги по ремонту окон",
            "Услуги по установке и обслуживанию окон",
            "Услуги по установке окон",
            "Услуги по установке натяжных потолков",
            "Услуги по монтажу инженерных систем",
            "Услуги по благоустройству и озеленению",
            "Садоводство и ландшафтный дизайн",
        ],
        "Риелторские услуги": [
            "Риелторские услуги",
            "Риэлторские услуги",
            "Агентство недвижимости",
            "Аренда недвижимости",
            "Продажа недвижимости",
            "Услуги по аренде недвижимости",
            "Услуги в сфере недвижимости",
            "Услуги в сфере недвижимости и документации",
            "Услуги в сфере недвижимости и кадастра",
            "Недвижимость",
            "Недвижимость / Строительство",
            "Недвижимость и рекламные услуги",
            "Недвижимость и строительство",
            "Недвижимость и финансовые услуги",
            "Недвижимость и франчайзинг",
            "Недвижимость, Автомобили",
        ],
    },
    "Транспорт, логистика и автобизнес": {
        "Перевозки и логистика": [
            "Грузоперевозки и логистика",
            "Логистика и грузоперевозки",
            "Логистика и доставка",
            "Логистика и курьерские услуги",
            "Логистика и перевозки",
            "Логистика и складские услуги",
            "Пассажирские перевозки",
            "Курьерские и почтовые услуги",
            "Курьерские услуги",
            "Складские услуги",
            "Почтовые и логистические услуги",
            "Транспортные услуги",
            "Транспортные услуги (Такси)",
            "Транспортные услуги (агрегатор)",
            "Услуги перевозок",
            "Услуги такси",
            "Агрегатор такси",
            "Авиаперевозки",
            "Водный транспорт",
            "Ж/д перевозки",
        ],
        "Автомобильный бизнес и услуги": [
            "Автомобильный бизнес",
            "Автомобильный бизнес / Выкуп автомобилей",
            "Автомобильный бизнес / Скупка автомобилей",
            "Торговля автомобилями",
            "Торговля автотранспортными средствами",
            "Торговля автотоварами",
            "Автозапчасти",
            "Автомобильные запчасти",
            "Продажа автозапчастей",
            "Автомобильные товары и услуги",
            "Автомобильные услуги",
            "Автомобильные услуги / Производство",
            "Автомобильные услуги / запчасти",
            "Автомобильные услуги и товары",
            "Автомобильные услуги и торговля",
            "Автосервис",
            "Автосервис и розничная торговля",
            "Автосервисные услуги",
            "Техническое обслуживание автомобилей",
            "Техническое обслуживание и ремонт автотранспортных средств",
            "Ремонт автомобилей",
            "Услуги по ремонту автомобилей",
            "Услуги автомойки",
            "Услуги шиномонтажа",
            "Автомойка, шиномонтаж",
            "Аренда автомобилей",
            "Аренда и выкуп автомобилей",
            "Услуги по выкупу автомобилей",
            "Автошкола",
            "Услуги автошкол",
            "Эвакуация",
        ],
        "Транспортные средства и спецтехника": [
            "Авиаперевозки",
            "Авиационные услуги",
            "Транспорт",
            "Продажа/аренда спецтехники",
            "Продажа и аренда спецтехники",
            "Продажа спецтехники",
            "Торговля спецтехникой",
        ],
    },
    "IT и телеком": {
        "Разработка ПО и IT-услуги": [
            "Разработка программного обеспечения",
            "Программное обеспечение",
            "Разработка мобильных приложений",
            "IT-услуги",
            "IT-сервисы",
            "IT-сервисы / Услуги для бизнеса",
            "IT-услуги для бизнеса",
            "IT-услуги и ремонт техники",
            "IT-услуги (сервис email-рассылок)",
            "IT-услуги / Маркетинг",
            "IT-услуги / Хостинг",
            "Администрирование и поддержка",
            "Услуги email-рассылок",
        ],
        "Интернет-компании и платформы": [
            "Интернет-сервисы",
            "IT / Интернет-сервисы",
            "Интернет-услуги",
            "Агрегаторы (такси, товаров, услуг)",
            "Онлайн-кинотеатры и игровые сервисы",
            "Онлайн-кинотеатр",
            "Игровые сервисы",
            "Игровая индустрия",
            "Онлайн-игры",
            "Рекламные платформы и технологии",
            "Рекламные платформы",
            "Рекламные технологии",
            "Рекламная площадка / Агрегатор объявлений",
            "Рекламные площадки",
        ],
        "Телекоммуникации и связь": [
            "Телекоммуникации",
            "Телекоммуникации / IT-услуги",
            "Телекоммуникации / Интернет-провайдер",
            "Телекоммуникации / Маркетинговые услуги",
            "Телекоммуникации / Платное ТВ",
            "Телекоммуникации / Рекламные услуги",
            "Телекоммуникации / Услуги связи",
            "Телекоммуникации / Финансовые услуги",
            "Телекоммуникации и IT",
            "Телекоммуникации и IT-услуги",
            "Телекоммуникации и медиа",
            "Телекоммуникации и рекламные услуги",
            "Телекоммуникации и финансовые услуги",
            "Телекоммуникации, Спортивные услуги",
            "Телекоммуникации, Финансовые услуги",
            "Телекоммуникационные услуги",
            "Услуги связи",
            "Услуги сотовой связи",
            "Интернет-провайдеры",
            "Телевидение и радиовещание",
            "Теле- и радиовещание",
            "Телевещание",
            "Телевидение",
            "Телевидение и медиа",
            "Телевизионное вещание",
            "Радиовещание",
            "Телерадиовещание",
        ],
    },
    "Финансы, страхование и консалтинг": {
        "Финансовые услуги": [
            "Финансовые услуги",
            "Финансовые услуги / Ломбард",
            "Финансовые услуги / Ломбарды",
            "Финансовые услуги / Недвижимость",
            "Финансовые услуги / Телекоммуникации",
            "Финансовые услуги, Медицинские услуги",
            "Финансовые услуги, Телекоммуникации",
            "Финансовые услуги, Телекоммуникации, IT",
            "Финансовые услуги, Телекоммуникации, Информационные технологии",
            "Банковские услуги",
            "Инвестиционные услуги",
            "Микрофинансовые организации",
            "Ломбарды",
            "Ломбардные услуги",
            "Ломбардные и комиссионные услуги",
        ],
        "Страхование": [
            "Страхование",
            "Страховые услуги",
            "Страховые и автомобильные услуги",
        ],
        "Профессиональные услуги (B2B)": [
            "Консалтинг (управленческий, стратегический)",
            "Консалтинговые услуги",
            "Консультационные услуги",
            "Консультационные и информационные услуги",
            "Консультационные и образовательные услуги",
            "Юридические услуги",
            "Юридические и бухгалтерские услуги",
            "Юридические и консультационные услуги",
            "Юридические и медицинские услуги",
            "Юридические и страховые услуги",
            "Юридические и экспертные услуги",
            "Юридические / консультационные услуги",
            "Юридические/консультационные услуги",
            "Юридические/финансовые услуги",
            "Юридические/экспертные услуги",
            "Финансовые/Юридические услуги",
            "Финансовые/юридические услуги",
            "Финансовые/юридические услуги, Недвижимость",
            "Финансовые и юридические услуги",
            "Бухгалтерские услуги",
            "Бухгалтерские услуги и аудит",
            "Экспертные и оценочные услуги",
            "Строительная экспертиза и юридические услуги",
            "Строительно-техническая экспертиза",
            "Сертификация и лицензирование",
            "Услуги по сертификации",
            "Услуги по сертификации и лицензированию",
            "Услуги по сертификации продукции",
            "Консультационные услуги в сфере сертификации",
            "Профессиональные услуги (сертификация)",
            "Кадровые услуги / Рекрутинг / HR",
            "Кадровые услуги",
            "Подбор персонала",
            "Подбор персонала / HR",
            "Рекрутинг",
            "Рекрутинг и HR",
            "Рекрутинг и трудоустройство",
            "Услуги по подбору персонала",
            "Услуги по трудоустройству",
        ],
    },
    "Медиа, реклама и маркетинг": {
        "Классические медиа и СМИ": [
            "Издательская деятельность",
            "Издательская деятельность / Медиа",
            "Издательская деятельность / Рекламораспространитель",
            "Издательская деятельность / СМИ",
            "Издательское дело",
            "Издательское дело / СМИ",
            "СМИ",
            "СМИ / Издательская деятельность",
            "СМИ / Издательское дело",
            "СМИ / Издательство",
            "СМИ / Информационный портал",
            "СМИ / Медиа",
            "СМИ / Печатные издания",
            "СМИ / Рекламные услуги",
            "СМИ / Рекламораспространитель",
            "СМИ / Телевещание",
            "СМИ и издательская деятельность",
            "СМИ и издательство",
            "СМИ и интернет-порталы",
            "СМИ и медиа",
            "Средства массовой информации",
            "Средства массовой информации / Радиовещание",
            "Печатные издания",
            "Телевидение и радио",
            "Информационные агентства",
        ],
        "Новые медиа и Digital": [
            "Онлайн-СМИ и информационные порталы",
            "Блогинг",
            "Блогинг / Создание контента",
            "Социальные сети и администрирование сообществ",
            "Администрирование интернет-сообществ",
            "Администрирование сообщества в соцсети",
            "Медиапроизводство",
            "Медиапроизводство / Рекламные услуги",
            "Производство медиаконтента",
            "Социальные медиа",
            "Социальные медиа / Владелец сообщества",
            "Информационные услуги / Блогинг",
            "Распространение информации (Telegram-канал)",
        ],
        "Реклама и маркетинг": [
            "Рекламные услуги",
            "Рекламные услуги / Блогинг",
            "Рекламные услуги / СМИ",
            "Рекламные услуги в социальных сетях",
            "Рекламораспространитель (владелец сообщества в соцсети)",
            "Реклама и медиа",
            "Рекламные и маркетинговые услуги",
            "Маркетинговые услуги",
            "Маркетинговые и рекламные услуги",
            "Маркетинговые и социологические исследования",
            "Маркетинговые услуги (колл-центр)",
            "Маркетинговые услуги, Финансовые услуги",
            "Маркетинг и консалтинг",
            "Маркетинг и реклама",
            "Деятельность рекламных агентств",
            "Распространение рекламы",
            "Распространение рекламы в социальных сетях",
            "Размещение рекламы",
            "Размещение рекламы в социальных сетях",
            "Наружная реклама",
            "Услуги по размещению рекламы",
            "PR-услуги",
            "Маркетинговые исследования и социология",
            "Разработка компьютерного программного обеспечения, рекламные услуги",
        ],
    },
    "Услуги для населения (B2C)": {
        "Красота и здоровье": [
            "Индустрия красоты",
            "Индустрия гостеприимства и красоты",
            "Услуги в сфере красоты",
            "Услуги в сфере красоты и здоровья",
            "Услуги в сфере здоровья и красоты",
            "Косметические услуги",
            "Косметические и оздоровительные услуги",
            "Косметические / Бытовые услуги",
            "Услуги салонов красоты",
            "Парикмахерские и барбершопы",
            "Парикмахерские услуги",
            "Парикмахерские услуги / Барбершоп",
            "SPA-услуги",
            "Медицинские услуги",
            "Медицинские и косметические услуги",
            "Медицинские услуги / Розничная торговля",
            "Медицинские услуги, Розничная торговля",
            "Оздоровительные услуги",
            "Фитнес и оздоровительные услуги",
            "Фитнес и спорт",
            "Фитнес-услуги",
            "Фитнес-услуги и косметология",
            "Фитнес-услуги и общественное питание",
            "Психологические услуги",
        ],
        "Образование и культура": [
            "Образовательные услуги",
            "Образовательные и консультационные услуги",
            "Образовательные услуги (авиационная школа)",
            "Образовательные услуги / Эзотерика",
            "Образовательные/Консультационные услуги",
            "Информационные/образовательные услуги",
            "Информационно-консультационные услуги",
            "Информационные и консультационные услуги",
            "Культура и искусство",
            "Культура и досуг",
            "Культура и развлечения",
            "Исполнительские искусства",
            "Услуги в сфере культуры и досуга",
            "Услуги в сфере образования",
        ],
        "Бытовые услуги": [
            "Бытовые услуги",
            "Клининг и химчистка",
            "Клининговые услуги",
            "Услуги химчистки и прачечной",
            "Услуги химчистки и стирки",
            "Ремонт (бытовой техники, обуви, электроники)",
            "Ремонт бытовой техники",
            "Ремонт бытовой техники и электроники",
            "Ремонт электроники",
            "Ремонт техники",
            "Ремонт обуви",
            "Услуги по ремонту техники",
            "Услуги по ремонту техники и копировальные услуги",
            "Сервисные услуги (ремонт электроники)",
            "Ритуальные услуги / Изготовление памятников",
            "Ритуальные услуги",
            "Изготовление памятников",
            "Ветеринарные услуги / Услуги для животных",
            "Ветеринарные услуги",
            "Услуги для животных",
            "Фотоуслуги",
            "Услуги по ремонту и вскрытию замков",
            "Услуги по вскрытию и ремонту замков",
        ],
        "ЖКХ и коммунальные услуги": [
            "Жилищно-коммунальное хозяйство",
            "Жилищно-коммунальные услуги",
            "Жилищно-коммунальные и информационные услуги",
            "Услуги ЖКХ",
            "Услуги в сфере ЖКХ",
            "Бытовые и коммунальные услуги",
            "Коммунальные и бытовые услуги",
            "Коммунальные услуги",
            "ЖКХ / Бытовые услуги",
            "ЖКХ и обработка данных",
            "Обслуживание домофонов",
            "Обслуживание домофонных систем",
            "Энерго- и газоснабжение",
            "Энергоснабжение",
            "Газоснабжение",
            "Услуги по газификации",
            "Услуги по снабжению газом",
            "Услуги по обслуживанию газового оборудования",
            "Услуги по установке и обслуживанию газового оборудования",
            "Поверка приборов учета",
            "Услуги по поверке приборов учета",
            "Услуги по поверке измерительных приборов",
            "Услуги по обслуживанию приборов учета воды",
        ],
    },
    "Общественное питание (HoReCa)": {
        "Ресторанный бизнес и общепит": [
            "Общественное питание",
            "Общественное питание / Доставка еды",
            "Общественное питание / Кальянная",
            "Общественное питание / Кальянные",
            "Общественное питание / Развлекательные услуги",
            "Общественное питание / Розничная торговля",
            "Общественное питание и доставка",
            "Общественное питание и доставка еды",
            "Общественное питание и розничная торговля",
            "Общественное питание, Досуг и развлечения",
            "Ресторанный бизнес",
            "Ресторанный бизнес и организация мероприятий",
            "Гостинично-ресторанный бизнес",
            "Деятельность ресторанов и услуги по доставке продуктов питания",
            "Услуги общественного питания",
            "Услуги в сфере общественного питания",
            "Услуги в сфере общественного питания и досуга",
            "Кальянная",
            "Услуги по доставке кальянов",
            "Кейтеринг",
        ],
        "Доставка еды": [
            "Доставка готовой еды",
            "Доставка еды",
            "Доставка продуктов питания",
            "Доставка алкогольной продукции",
            "Доставка питьевой воды",
            "Услуги доставки питания",
            "Услуги доставки",
            "Сервисы доставки еды",
            "Фудтех-сервисы",
        ],
        "Гостиничный бизнес и туризм": [
            "Гостиничные услуги",
            "Гостиничные услуги / Краткосрочная аренда жилья",
            "Гостиничный и курортный бизнес",
            "Игорный бизнес и гостиничные услуги",
            "Санатории и курорты",
            "Санаторно-курортные услуги",
            "Туристические услуги",
            "Туризм",
            "Туризм и гостеприимство",
            "Туризм и гостиничные услуги",
            "Туризм и отдых",
            "Туризм и развлечения",
            "Краткосрочная аренда жилья",
        ],
    },
    "Развлечения, спорт и досуг": {
        "Игорный бизнес и азартные игры": [
            "Азартные игры",
            "Азартные игры / Букмекерские услуги",
            "Азартные игры / Казино",
            "Азартные игры / Лотереи",
            "Азартные игры / Онлайн-игры",
            "Азартные игры / Онлайн-казино",
            "Азартные игры и пари",
            "Азартные игры и ставки на спорт",
            "Букмекерские услуги",
            "Букмекерские услуги / Азартные игры",
            "Казино, игровые автоматы",
            "Букмекерские конторы / Ставки на спорт",
            "Организация и проведение лотерей",
            "Организация лотерей",
            "Лотереи и азартные игры",
            "Онлайн-казино и игры",
        ],
        "Развлекательные мероприятия и услуги": [
            "Организация мероприятий",
            "Организация мероприятий / Общественное питание",
            "Организация зрелищных мероприятий",
            "Зрелищно-развлекательные мероприятия",
            "Развлекательные мероприятия",
            "Развлекательные услуги",
            "Развлечения",
            "Развлечения / Досуг",
            "Развлечения и досуг",
            "Развлечения и мероприятия",
            "Досуг и развлечения",
            "Услуги в сфере досуга",
            "Услуги в сфере досуга и развлечений",
            "Услуги в сфере досуга и спорта",
            "Услуги в сфере развлечений и досуга",
            "Услуги в сфере отдыха и развлечений",
            "Услуги для отдыха и развлечений",
            "Услуги отдыха и развлечений",
            "Сфера развлечений и общественного питания",
            "Кинопрокат",
            "Кинопрокат и развлечения",
            "Концерты и шоу",
            "Парки развлечений и аттракционы",
            "Организация детского досуга",
            "Организация досуга и отдыха",
            "Продажа билетов / Организация мероприятий",
            "Продажа билетов на мероприятия",
        ],
        "Спорт и активный отдых": [
            "Спортивные услуги",
            "Спортивные услуги / Фитнес",
            "Спортивные и оздоровительные услуги",
            "Спортивно-оздоровительные услуги",
            "Спортивные мероприятия и услуги",
            "Спорт и развлечения",
            "Услуги в сфере спорта и отдыха",
            "Услуги в сфере пожарной безопасности",
            "Физкультурно-оздоровительные услуги",
            "Спортивные товары",
            "Спортивное питание",
        ],
    },
    "Особые и ресурсные отрасли": {
        "Обращение с отходами и вторсырьем": [
            "Сбор и переработка вторсырья",
            "Сбор и обработка вторсырья",
            "Сбор и переработка лома",
            "Сбор и переработка металлолома",
            "Сбор и обработка металлолома",
            "Заготовка и переработка лома металлов",
            "Заготовка и переработка металлолома",
            "Закупка и переработка металлолома",
            "Закупка лома металлов",
            "Закупка/переработка вторсырья",
            "Обращение с ломом металлов",
            "Обращение с отходами",
            "Сбор и переработка отходов",
            "Сбор и переработка отходов / лома",
            "Сбор и переработка отходов / лома металлов",
            "Сбор и утилизация отходов",
            "Сбор металлолома",
            "Сбор и торговля металлоломом",
            "Скупка и переработка вторсырья",
            "Утилизация отходов",
            "Утилизация и обработка металлолома",
            "Обработка вторсырья",
            "Торговля отходами и ломом",
            "Услуги по сбору вторсырья",
            "Услуги по приему лома",
            "Услуги по приему металлолома",
            "Услуги по скупке вторсырья",
            "Услуги по скупке лома",
            "Закупка и продажа поддонов",
            "Транспортные услуги и сбор вторсырья",
        ],
        "Специализированные услуги": [
            "Охранные услуги",
            "Охранные услуги / Безопасность",
            "Услуги безопасности",
            "Услуги дезинфекции",
            "Услуги дезинсекции",
            "Услуги дезинфекции и дератизации",
            "Дезинфекция, дератизация",
            "Эзотерические и оккультные услуги",
            "Эзотерические услуги",
            "Эзотерические/персональные услуги",
            "Оккультные / мистические услуги",
            "Оккультные услуги",
            "Государственное управление / Органы власти",
            "Государственное управление",
            "Государственный орган",
            "Органы местного самоуправления",
            "Общественная деятельность",
            "Политические организации",
            "Профессиональные ассоциации",
            "Некоммерческие организации (НКО) и благотворительность",
            "Некоммерческая организация",
            "Благотворительность / Социальные услуги",
            "Социальные услуги",
        ],
    },
}


def build_reverse_mapping():
    """
    Построить обратный маппинг: реальное значение из БД -> категория классификации.
    Возвращает dict: { "реальное_значение": "Отрасль / Сфера / Специализация" }
    """
    reverse_map = {}
    
    for industry, spheres in INDUSTRY_HIERARCHY.items():
        for sphere, specializations in spheres.items():
            for spec in specializations:
                # spec - это реальное значение из БД
                # Ключ для фильтра: "Отрасль / Сфера / Специализация"
                filter_key = f"{industry} / {sphere} / {spec}"
                reverse_map[spec] = filter_key
    
    return reverse_map


def get_filter_values_for_category(industry: str, sphere: str, spec: str) -> list:
    """
    Получить список реальных значений из БД для категории фильтра.
    Возвращает список значений defendant_industry, которые соответствуют этой категории.
    """
    if industry in INDUSTRY_HIERARCHY:
        if sphere in INDUSTRY_HIERARCHY[industry]:
            if spec in INDUSTRY_HIERARCHY[industry][sphere]:
                return [spec]
    return []


def expand_filter_categories(selected_categories: list) -> list:
    """
    Разворачивает выбранные категории фильтра в список реальных значений из БД.
    
    Аргументы:
        selected_categories: список строк - могут быть:
                            - Отрасль (уровень 1): "Торговля"
                            - Сфера (уровень 2): "Розничная торговля (Ритейл)"  
                            - Специализация (уровень 3): "Розничная торговля" (реальное значение из БД)
    
    Возвращает:
        Список реальных значений defendant_industry из БД
    """
    if not selected_categories:
        return []
    
    result = set()
    
    for category in selected_categories:
        # Сначала проверяем, является ли это реальным значением из БД (уровень 3)
        # Для этого ищем значение во всех списках специализаций
        found_as_spec = False
        for industry, spheres in INDUSTRY_HIERARCHY.items():
            for sphere, specs in spheres.items():
                if category in specs:
                    result.add(category)
                    found_as_spec = True
                    break
            if found_as_spec:
                break
        
        if found_as_spec:
            continue
        
        # Проверяем, является ли это отраслью (уровень 1)
        if category in INDUSTRY_HIERARCHY:
            for sphere, specs in INDUSTRY_HIERARCHY[category].items():
                for spec in specs:
                    result.add(spec)
            continue
        
        # Проверяем, является ли это сферой (уровень 2)
        found_as_sphere = False
        for industry, spheres in INDUSTRY_HIERARCHY.items():
            if category in spheres:
                found_as_sphere = True
                for spec in spheres[category]:
                    result.add(spec)
                break
        
        if found_as_sphere:
            continue
        
        # Если не найдено - возможно это формат "Отрасль / Сфера" или "Отрасль / Сфера / Спец"
        parts = [p.strip() for p in category.split(" / ")]
        
        if len(parts) == 2:
            # Формат "Отрасль / Сфера"
            industry, sphere = parts
            if industry in INDUSTRY_HIERARCHY:
                if sphere in INDUSTRY_HIERARCHY[industry]:
                    for spec in INDUSTRY_HIERARCHY[industry][sphere]:
                        result.add(spec)
        
        elif len(parts) >= 3:
            # Формат "Отрасль / Сфера / Специализация"
            industry, sphere, spec = parts[0], parts[1], parts[2]
            if industry in INDUSTRY_HIERARCHY:
                if sphere in INDUSTRY_HIERARCHY[industry]:
                    if spec in INDUSTRY_HIERARCHY[industry][sphere]:
                        result.add(spec)
    
    return list(result)


def get_all_industry_values():
    """
    Получить все уникальные значения defendant_industry из маппинга.
    """
    result = set()
    for industry, spheres in INDUSTRY_HIERARCHY.items():
        for sphere, specs in spheres.items():
            for spec in specs:
                result.add(spec)
    return list(result)